<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>lovezj9012</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="lovezj9012">
<meta property="og:url" content="http://example.com/page/12/index.html">
<meta property="og:site_name" content="lovezj9012">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="zhang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="lovezj9012" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">lovezj9012</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Suche"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-SQL Server 常用函数" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/12/12/SQL%20Server%20%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" class="article-date">
  <time class="dt-published" datetime="2018-12-12T09:15:00.000Z" itemprop="datePublished">2018-12-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MySQL-SQL-Oracle/">MySQL/SQL/Oracle</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/12/12/SQL%20Server%20%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/">SQL Server 常用函数</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="SUBSTRING-expression-start-length"><a href="#SUBSTRING-expression-start-length" class="headerlink" title="SUBSTRING ( expression ,start , length )"></a>SUBSTRING ( expression ,start , length )</h2><p>参数</p>
<p>. expression<br>字符串、二进制字符串、文本、图像、列或包含列的表达式。不要使用包含聚合函数的表达式。</p>
<p>.start<br>指定子字符串从何处开始的整数。start可以是bigint类型；索引从1开始</p>
<p>.length<br>长度是一个正整数，它指定返回表达式的字符或字节数。如果长度为负值，则返回错误。长度可以是bigint型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;LGAG4DY30B353&#x27;</span>,<span class="number">1</span>,<span class="number">10</span>)  <span class="comment">--截取前10位返回结果 LGAG4DY30B</span></span><br></pre></td></tr></table></figure>

<h2 id="STUFF-character-expression-start-length-replaceWith-expression"><a href="#STUFF-character-expression-start-length-replaceWith-expression" class="headerlink" title="STUFF ( character_expression , start , length , replaceWith_expression )"></a>STUFF ( character_expression , start , length , replaceWith_expression )</h2><p>参数</p>
<p>.character_expression<br>字符数据的表达式可以是常量、变量，也可以是字符列或二进制数据列。</p>
<p>.start<br>一个整数值，指定删除和插入的开始位置。 如果 start 为负或为零，则返回空字符串。 如果 start 的长度大于第一个 character_expression，则返回空字符串。 start 的类型可以是 bigint。索引从1开始。</p>
<p>.length<br>一个整数，指定要删除的字符数。 如果 length 为负，则返回空字符串。 如果 length 的长度大于第一个 character_expression，则最多可以删除到最后一个 character_expression 中的最后一个字符。 如果 length 为零，则在字符串中第一个字符之前插入内容。 length 的类型可以是 bigint。</p>
<p>.replaceWith_expression<br>字符数据的表达式。 character_expression 可以是常量、变量，也可以是字符列或二进制数据列。 此表达式从 start 开始替换 length 个字符的 character_expression。 如果 replaceWith_expression 为 NULL，则在不插入任何内容的情况下删除字符。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUFF(<span class="string">&#x27;LGAG4DY30B&#x27;</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="string">&#x27;-&#x27;</span>) <span class="comment">--返回结果 LGAG4DY3-B</span></span><br></pre></td></tr></table></figure>

<p><strong>SELECT 字段 FROM 表名 FOR JSON AUTO</strong><br><strong>SELECT 字段 FROM 表名 FOR JSON PATH</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> top <span class="number">1</span> Id,Name,CreateTime <span class="keyword">from</span> Log <span class="keyword">for</span> json path  <span class="comment">--返回结果 [&#123;&quot;Id&quot;:1,&quot;Name&quot;:&quot;车辆信息查询&quot;,&quot;CreateTime&quot;:&quot;2018-09-06T09:00:28.090&quot;&#125;]</span></span><br></pre></td></tr></table></figure>

<p><strong>SELECT 字段 FROM 表名 FOR JSON PATH，ROOT(‘ ‘)</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> top <span class="number">1</span> Id,Name,CreateTime <span class="keyword">from</span> Log <span class="keyword">for</span> json path,root(<span class="string">&#x27;Log&#x27;</span>)  <span class="comment">--返回结果 &#123;&quot;Log&quot;:[&#123;&quot;Id&quot;:1,&quot;Name&quot;:&quot;车辆信息查询&quot;,&quot;CreateTime&quot;:&quot;2018-09-06T09:00:28.090&quot;&#125;]&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>FOR XML PATH 用法类似</strong><br><strong>FOR XML PATH和STUFF结合使用，将字段用逗号连接起来</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> STUFF((<span class="keyword">select</span> <span class="string">&#x27;,&#x27;</span><span class="operator">+</span><span class="keyword">CONVERT</span>(<span class="type">varchar</span>(<span class="number">200</span>),ID) <span class="keyword">from</span>  SMP_Case <span class="keyword">for</span> xml path(<span class="string">&#x27;&#x27;</span>)),<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> IDs</span><br></pre></td></tr></table></figure>

<h2 id="CHARINDEX-expressionToFind-expressionToSearch-start-location"><a href="#CHARINDEX-expressionToFind-expressionToSearch-start-location" class="headerlink" title="CHARINDEX ( expressionToFind , expressionToSearch [ , start_location ] )"></a>CHARINDEX ( expressionToFind , expressionToSearch [ , start_location ] )</h2><p>参数</p>
<p>.expressionToFind<br>一个字符表达式，其中包含要查找的序列。 expressionToFind 限制为 8000 个字符 。</p>
<p>.expressionToSearch<br>要搜索的字符表达式。</p>
<p>.start_location<br>表示搜索开始位置的 integer 或 bigint 表达式 。 如果 start_location 未指定、具有负数值或 0，搜索将从 expressionToSearch 的开头开始 。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> CHARINDEX(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;LGWE13243-ABC&#x27;</span>)  <span class="comment">--返回结果10</span></span><br></pre></td></tr></table></figure>

<h2 id="PATINDEX-‘-pattern-’-expression"><a href="#PATINDEX-‘-pattern-’-expression" class="headerlink" title="PATINDEX ( ‘%pattern%’ , expression )"></a>PATINDEX ( ‘%pattern%’ , expression )</h2><p>参数</p>
<p>.pattern<br>包含要查找的序列的字符表达式。 可以使用通配符；但 pattern 之前和之后必须有 % 字符（搜索第一个或最后一个字符时除外） 。 pattern 是字符串数据类型类别的表达式 。 pattern最多包含 8000 个字符 。</p>
<p>.expression<br>是一个expression，通常是针对指定模式搜索的列。 expression 是字符串数据类型类别的表达式 。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> PATINDEX(<span class="string">&#x27;%-%&#x27;</span>,<span class="string">&#x27;243532B-ACFDF3333&#x27;</span>) <span class="comment">--返回结果8</span></span><br></pre></td></tr></table></figure>

<p>参考：  <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/sql/t-sql/functions/len-transact-sql?view=sql-server-2017">https://docs.microsoft.com/zh-cn/sql/t-sql/functions/len-transact-sql?view=sql-server-2017</a></p>
<p>　　　<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sql/relational-databases/json/format-query-results-as-json-with-for-json-sql-server?view=sql-server-2017">https://docs.microsoft.com/en-us/sql/relational-databases/json/format-query-results-as-json-with-for-json-sql-server?view=sql-server-2017</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/12/SQL%20Server%20%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" data-id="clnvbvla400ahegur4y9hgq86" data-title="SQL Server 常用函数" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL-SQL-Oracle/" rel="tag">MySQL&#x2F;SQL&#x2F;Oracle</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-API 接口收集" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/12/12/API%20%E6%8E%A5%E5%8F%A3%E6%94%B6%E9%9B%86/" class="article-date">
  <time class="dt-published" datetime="2018-12-12T08:40:00.000Z" itemprop="datePublished">2018-12-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Other/">Other</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/12/12/API%20%E6%8E%A5%E5%8F%A3%E6%94%B6%E9%9B%86/">API 接口收集</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>节假日</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://api.goseek.cn/</span><br><span class="line">http://timor.tech/api/holiday</span><br><span class="line">http://www.easybots.cn/api/holiday.php?d=20130101</span><br><span class="line">https://tool.bitefu.net/jiari/?d=20181001&amp;info=1</span><br></pre></td></tr></table></figure>

<p>发票验证</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://market.aliyun.com/products/56928005/cmapi025075.html?spm=5176.10695662.1996646101.searchclickresult.112d7d3dtnP9jR#sku=yuncode1907500000</span><br><span class="line">https://market.aliyun.com/products/57124001/cmapi027758.html#sku=yuncode2175800000</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/12/API%20%E6%8E%A5%E5%8F%A3%E6%94%B6%E9%9B%86/" data-id="clnvbvl7h0001egurcrh183yt" data-title="API 接口收集" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Other/" rel="tag">Other</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Json 序列化为Dictionary" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/16/Json%20%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%BADictionary/" class="article-date">
  <time class="dt-published" datetime="2018-11-16T02:56:00.000Z" itemprop="datePublished">2018-11-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-WinForm/">C#/WinForm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/16/Json%20%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%BADictionary/">Json 序列化为Dictionary</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>如下所示的json字符串中包含中文属性转换成英文属性</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="attr">&quot;sid&quot;</span><span class="punctuation">:</span><span class="string">&quot;dd1312&quot;</span><span class="punctuation">,</span><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;发票代码&quot;</span><span class="punctuation">:</span> <span class="string">&quot;032001500XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;发票号码&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25272XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;开票日期&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2017年XX月XX日&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;校验码&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15922733756000XXXXXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;发票金额&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX.00&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;发票税额&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX.43&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;不含税金额&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX.57&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;受票方名称&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;受票方税号&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;受票方地址、电话&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;受票方开户行、账号&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;销售方名称&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;销售方税号&quot;</span><span class="punctuation">:</span> <span class="string">&quot;913201043023368XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;销售方地址、电话&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;销售方开户行、账号&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XXX&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>现将json字符串转换成Dictionary类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 将Json数据反序列化为Dictionary</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;jsonData&quot;&gt;</span>json数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; <span class="title">JsonToDictionary</span>(<span class="params"><span class="built_in">string</span> sonData</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//实例化JavaScriptSerializer类的新实例</span></span><br><span class="line">    JavaScriptSerializer javaScriptSerializer = <span class="keyword">new</span> JavaScriptSerializer();</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//将指定的 JSON 字符串转换为 Dictionary&lt;string, object&gt; 类型的对象</span></span><br><span class="line">        <span class="keyword">return</span> javaScriptSerializer.Deserialize&lt;Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;&gt;(jsonData);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(ex.Message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后将中文属性转换成对应的英文属性</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">Dictionary&lt;<span class="built_in">string</span>,<span class="built_in">object</span>&gt; dic = JsonToDictionary(ress);</span><br><span class="line">InvoiceAliOcr res = <span class="keyword">new</span> InvoiceAliOcr();</span><br><span class="line">res.data = <span class="keyword">new</span> Ocr();</span><br><span class="line"><span class="keyword">if</span> (dic != <span class="literal">null</span> &amp;&amp;dic.ContainsKey(<span class="string">&quot;data&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; dataSet = (Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;)dic[<span class="string">&quot;data&quot;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; item <span class="keyword">in</span> dataSet)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (item.Key)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;发票代码&quot;</span>:</span><br><span class="line">                res.data.fpdm = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;发票号码&quot;</span>:</span><br><span class="line">                res.data.fphm = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;开票日期&quot;</span>:</span><br><span class="line">                res.data.kprq = <span class="built_in">string</span>.IsNullOrEmpty(item.Value.ToString()) ? <span class="string">&quot;&quot;</span> : Convert.ToDateTime(item.Value.ToString()).ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;校验码&quot;</span>:</span><br><span class="line">                res.data.code = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;发票金额&quot;</span>:</span><br><span class="line">                res.data.sumamount = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;发票税额&quot;</span>:</span><br><span class="line">                res.data.taxamount = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;不含税金额&quot;</span>:</span><br><span class="line">                res.data.notaxamount = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;受票方名称&quot;</span>:</span><br><span class="line">                res.data.gfMc = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;受票方税号&quot;</span>:</span><br><span class="line">                res.data.gfCode = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;销售方名称&quot;</span>:</span><br><span class="line">                res.data.sfMc = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;销售方税号&quot;</span>:</span><br><span class="line">                res.data.sfCode = item.Value.ToString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/16/Json%20%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%BADictionary/" data-id="clnvbvl92005yegur8ngn13g2" data-title="Json 序列化为Dictionary" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-WinForm/" rel="tag">C#&#x2F;WinForm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-RedisClient 连接redis 提示 ERR Client sent AUTH, but no password is set" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/16/RedisClient%20%E8%BF%9E%E6%8E%A5redis%20%E6%8F%90%E7%A4%BA%20ERR%20Client%20sent%20AUTH,%20but%20no%20password%20is%20set/" class="article-date">
  <time class="dt-published" datetime="2018-11-16T02:56:00.000Z" itemprop="datePublished">2018-11-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MVC/">MVC</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/16/RedisClient%20%E8%BF%9E%E6%8E%A5redis%20%E6%8F%90%E7%A4%BA%20ERR%20Client%20sent%20AUTH,%20but%20no%20password%20is%20set/">RedisClient 连接redis 提示 ERR Client sent AUTH, but no password is set</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><img src="/images/2018111610561601.png" alt="2018111610561601.png"><br>使用redisclient连接redis出现上图的错误</p>
<p>在配置中已经找到requirepass修改了密码，但是还是出现上图错误。在网上找了资料在dos设置<br><img src="/images/2018111610561602.png" alt="2018111610561602.png"></p>
<p>出现上图红框中的错误，研究了半天也没有解决。后来将配置中的requirepass重新注释掉，在重新配置就可以了。<br><img src="/images/2018111610561603.png" alt="2018111610561603.png"></p>
<p>参考文章 <a target="_blank" rel="noopener" href="http://www.cnblogs.com/robinli/p/9265186.html">http://www.cnblogs.com/robinli/p/9265186.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/16/RedisClient%20%E8%BF%9E%E6%8E%A5redis%20%E6%8F%90%E7%A4%BA%20ERR%20Client%20sent%20AUTH,%20but%20no%20password%20is%20set/" data-id="clnvbvla300aaegurd2v7596h" data-title="RedisClient 连接redis 提示 ERR Client sent AUTH, but no password is set" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/" rel="tag">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-MVC JSON JavaScriptSerializer 进行序列化或反序列化时出错" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/12/MVC%20JSON%20JavaScriptSerializer%20%E8%BF%9B%E8%A1%8C%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%96%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E5%87%BA%E9%94%99/" class="article-date">
  <time class="dt-published" datetime="2018-11-12T07:46:00.000Z" itemprop="datePublished">2018-11-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MVC/">MVC</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/12/MVC%20JSON%20JavaScriptSerializer%20%E8%BF%9B%E8%A1%8C%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%96%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E5%87%BA%E9%94%99/">MVC JSON JavaScriptSerializer 进行序列化或反序列化时出错</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>MVC control中返回json格式数据一般都是如下格式</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">CaseAudit</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> data =<span class="string">&quot;dasda&quot;</span>；    </span><br><span class="line">    <span class="keyword">return</span> Json(data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这样如果字符串长度太大会报错</p>
<p><strong>JSON JavaScriptSerializer 进行序列化或反序列化时出错。字符串的长度超过了为 maxJsonLength 属性设置的值</strong></p>
<p>按下面方法可以解决</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">CaseAudit</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> data =<span class="string">&quot;dasda&quot;</span>；    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> JsonResult() &#123; Data = data, MaxJsonLength = <span class="built_in">int</span>.MaxValue, ContentType = <span class="string">&quot;application/json&quot;</span> &#125;；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者在Web.config中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">system.web.extensions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scripting</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">webServices</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jsonSerialization</span> <span class="attr">maxJsonLength</span>=<span class="string">&quot;1024000000&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">webServices</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">scripting</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">system.web.extensions</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/12/MVC%20JSON%20JavaScriptSerializer%20%E8%BF%9B%E8%A1%8C%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%96%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E5%87%BA%E9%94%99/" data-id="clnvbvl94006aegur04v31py7" data-title="MVC JSON JavaScriptSerializer 进行序列化或反序列化时出错" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/" rel="tag">MVC</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-MVC Control 接收post请求的json数据" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/07/MVC%20Control%20%E6%8E%A5%E6%94%B6post%E8%AF%B7%E6%B1%82%E7%9A%84json%E6%95%B0%E6%8D%AE/" class="article-date">
  <time class="dt-published" datetime="2018-11-07T06:39:00.000Z" itemprop="datePublished">2018-11-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MVC/">MVC</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/07/MVC%20Control%20%E6%8E%A5%E6%94%B6post%E8%AF%B7%E6%B1%82%E7%9A%84json%E6%95%B0%E6%8D%AE/">MVC Control 接收post请求的json数据</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">QueryInvoice</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> stream;</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> sr = <span class="keyword">new</span> StreamReader(Request.InputStream))</span><br><span class="line">    &#123;</span><br><span class="line">        stream = sr.ReadToEnd();</span><br><span class="line">    &#125;</span><br><span class="line">    JavaScriptSerializer js = <span class="keyword">new</span> JavaScriptSerializer();</span><br><span class="line">    QueryInfo info = js.Deserialize&lt;QueryInfo&gt;(stream);</span><br><span class="line">    <span class="keyword">if</span> (info == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> “请输入正确参数”;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QueryInfo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> caseNumber &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> picture &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/07/MVC%20Control%20%E6%8E%A5%E6%94%B6post%E8%AF%B7%E6%B1%82%E7%9A%84json%E6%95%B0%E6%8D%AE/" data-id="clnvbvl940067egurgx7y7jao" data-title="MVC Control 接收post请求的json数据" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/" rel="tag">MVC</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Python 数据类型" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/04/Python%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="article-date">
  <time class="dt-published" datetime="2018-09-04T03:01:00.000Z" itemprop="datePublished">2018-09-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/04/Python%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Python 数据类型</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Python数据类型"><a href="#Python数据类型" class="headerlink" title="Python数据类型"></a>Python数据类型</h2><p>查看数据类型的方法：例如看int类型的方法，在pycharm里 输入int，然后按住ctrl鼠标点击int即可查看int类型的方法</p>
<h3 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h3><p>int （整型）</p>
<p>在python2中<br>在32位机器上，整数的位数为32位，范围是 -231<del>231-1<br>在64位机器上，整数的位数为64位，范围是 -263</del>263-1</p>
<p>在python3中<br>整型长度无限制<br><img src="/images/2018091411011101.png" alt="2018091411011101.png"></p>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p><img src="/images/2018091411011102.png" alt="2018091411011102.png"><br>特性：</p>
<ol>
<li>字符串按照从左到右的字符集存放，可以使用索引的方式访问（从0开始），是有序的</li>
<li>只能存放一个值，不可变</li>
</ol>
<h3 id="布尔"><a href="#布尔" class="headerlink" title="布尔"></a>布尔</h3><p>真或假<br>假包括 False、0、空字符串（‘ ’）、[]列表、（）元组、{}字典、None</p>
<h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><p>创建列表<br>lst &#x3D; [1, 3, ‘jack’]  或者<br>lst &#x3D; list([1, 3, ‘jack’])</p>
<p>特性:</p>
<ol>
<li>可以存放多个值</li>
<li>可以使用索引的方式访问（从0开始），是<strong>有序</strong>的</li>
<li><strong>可以</strong>修改指定索引对应的值</li>
</ol>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><p>创建元组<br>tu &#x3D; (1, 2, [‘jack’], ‘abc’,)   或者<br>tu &#x3D; list((1, 2, [‘jack’], ‘abc’,))</p>
<p>特性</p>
<ol>
<li>可以存放多个值</li>
<li>可以使用索引的方式访问（从0开始），是<strong>有序</strong>的</li>
<li><strong>不可以</strong>修改指定索引对应的值</li>
</ol>
<h3 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h3><p>创建字典<br>dic &#x3D; {‘name’: ‘jack’, ‘age’: 18}  或者<br>dic &#x3D; dict({‘name’: ‘jack’, ‘age’: 18})</p>
<p>特性</p>
<ol>
<li>可以存放多个值</li>
<li><strong>可以</strong>使用键值对的方式访问，是<strong>无序</strong>的</li>
</ol>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>创建集合<br>s &#x3D; {1, 3, (1, 5, 9), [‘jack’, 2]} 或者<br>s &#x3D; set({1, 3, (1, 5, 9), [‘jack’, 2]})</p>
<p>特性</p>
<ol>
<li><strong>无序且不重复</strong>元素的集合</li>
</ol>
<h2 id="Python运算符"><a href="#Python运算符" class="headerlink" title="Python运算符"></a>Python运算符</h2><h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><p><img src="/images/2018091411011103.png" alt="2018091411011103.png"></p>
<h3 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h3><p><img src="/images/2018091411011104.png" alt="2018091411011104.png"></p>
<h3 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h3><p><img src="/images/2018091411011105.png" alt="2018091411011105.png"></p>
<h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><p><img src="/images/2018091411011106.png" alt="2018091411011106.png"></p>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p><img src="/images/2018091411011107.png" alt="2018091411011107.png"></p>
<h3 id="成员运算符"><a href="#成员运算符" class="headerlink" title="成员运算符"></a>成员运算符</h3><p><img src="/images/2018091411011108.png" alt="2018091411011108.png"></p>
<h3 id="身份运算符"><a href="#身份运算符" class="headerlink" title="身份运算符"></a>身份运算符</h3><p><img src="/images/2018091411011109.png" alt="2018091411011109.png"></p>
<h3 id="运算符优先级"><a href="#运算符优先级" class="headerlink" title="运算符优先级"></a>运算符优先级</h3><p><img src="/images/2018091411011110.png" alt="2018091411011110.png"></p>
<h2 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h2><p><img src="/images/2018091411011111.png" alt="2018091411011111.png"></p>
<h2 id="数据类型分类"><a href="#数据类型分类" class="headerlink" title="数据类型分类"></a>数据类型分类</h2><p>按存值个数区分</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>标量／原子类型</td>
<td>数字，字符串</td>
</tr>
<tr>
<td>容器类型</td>
<td>列表，元组，字典</td>
</tr>
</tbody></table>
<p>按可变不可变区分</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>可变</td>
<td>列表，字典</td>
</tr>
<tr>
<td>不可变</td>
<td>数字，字符串，元组</td>
</tr>
</tbody></table>
<p>按访问顺序区分</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>直接访问</td>
<td>数字</td>
</tr>
<tr>
<td>顺序访问（序列类型）</td>
<td>字符串，列表，元组</td>
</tr>
<tr>
<td>key值访问（映射类型）</td>
<td>字典</td>
</tr>
</tbody></table>
<p>参考：<a target="_blank" rel="noopener" href="http://www.runoob.com/python/python-operators.html">http://www.runoob.com/python/python-operators.html</a></p>
<p>　　　<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/stdtypes.html">https://docs.python.org/3/library/stdtypes.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/linhaifeng/articles/5935801.html">http://www.cnblogs.com/linhaifeng/articles/5935801.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/04/Python%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" data-id="clnvbvl9y009oegur0rbl653c" data-title="Python 数据类型" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Quartz和TopShelf Windows服务作业调度" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/07/18/Quartz%E5%92%8CTopShelf%20Windows%E6%9C%8D%E5%8A%A1%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6/" class="article-date">
  <time class="dt-published" datetime="2018-07-18T03:49:00.000Z" itemprop="datePublished">2018-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-WinForm/">C#/WinForm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/18/Quartz%E5%92%8CTopShelf%20Windows%E6%9C%8D%E5%8A%A1%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6/">Quartz和TopShelf Windows服务作业调度</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>上一次写了一遍关于Quartz作业调度的文章</p>
<p>现在使用TopShelf和Quartz实现windows服务作业调度</p>
<p>TopShelf版本4.0<br>Quartz版本3.0.6</p>
<p>任务文件和上次文章的一样将日期写入txt文件中，TimeJob代码如下</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TimeJob</span> : <span class="title">IJob</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Execute</span>(<span class="params">IJobExecutionContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filePath = <span class="string">@&quot;D:\\log.txt&quot;</span>;</span><br><span class="line">        File.AppendAllText(filePath, DateTime.Now.ToString(<span class="string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>) + Environment.NewLine);</span><br><span class="line">        Console.WriteLine(DateTime.Now.ToString(<span class="string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>) + Environment.NewLine);</span><br><span class="line">        <span class="keyword">return</span> Task.FromResult(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>.创建调度器工厂  ISchedulerFactory factory &#x3D; new StdSchedulerFactory();</li>
<li>创建任务调度器 IScheduler scheduler &#x3D; null;</li>
<li>创建任务和触发器</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scheduler = <span class="keyword">await</span> factory.GetScheduler();</span><br><span class="line"><span class="comment">//创建一个任务</span></span><br><span class="line">IJobDetail job = JobBuilder.Create&lt;TimeJob&gt;().WithIdentity<span class="string">&quot;myJob1&quot;</span>, <span class="string">&quot;group1&quot;</span>).Build();</span><br><span class="line"><span class="comment">//创建一个触发器</span></span><br><span class="line">ITrigger trigger = TriggerBuilder.Create().WithIdentity<span class="string">&quot;myTrigger1&quot;</span>, <span class="string">&quot;group1&quot;</span>).StartNow().</span><br><span class="line">    WithSimpleSchedule(a =&gt; a.WithIntervalInSeconds(<span class="number">10</span>).RepeatForever()).Build();</span><br><span class="line"><span class="comment">//将任务和触发器添加到调度器里</span></span><br><span class="line"><span class="keyword">await</span> scheduler.ScheduleJob(job, trigger);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>开始执行 scheduler.Start()<br>Manager代码如下</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Manager</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//创建调度器工厂</span></span><br><span class="line">    ISchedulerFactory factory = <span class="keyword">new</span> StdSchedulerFactory();</span><br><span class="line">    <span class="comment">//创建调度器</span></span><br><span class="line">    IScheduler scheduler = <span class="literal">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Manager</span>()</span> &#123;</span><br><span class="line">        Init();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">Init</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        scheduler = <span class="keyword">await</span> factory.GetScheduler();</span><br><span class="line">        <span class="comment">//创建一个任务</span></span><br><span class="line">        IJobDetail job = JobBuilder.Create&lt;TimeJob&gt;().WithIdentity(<span class="string">&quot;myJob1&quot;</span>, <span class="string">&quot;group1&quot;</span>).Build();</span><br><span class="line">        <span class="comment">//创建一个触发器</span></span><br><span class="line">        ITrigger trigger = TriggerBuilder.Create().WithIdentity(<span class="string">&quot;myTrigger1&quot;</span>, <span class="string">&quot;group1&quot;</span>).StartNow().</span><br><span class="line">            WithSimpleSchedule(a =&gt; a.WithIntervalInSeconds(<span class="number">10</span>).RepeatForever()).Build();</span><br><span class="line">        <span class="comment">//将任务和触发器添加到调度器里</span></span><br><span class="line">        <span class="keyword">await</span> scheduler.ScheduleJob(job, trigger);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//开始执行</span></span><br><span class="line">        <span class="keyword">await</span> scheduler.Start();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">Stop</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//停止</span></span><br><span class="line">        <span class="keyword">await</span> scheduler.Shutdown(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">Pause</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//暂停</span></span><br><span class="line">        <span class="keyword">await</span> scheduler.PauseAll();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">Continue</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//继续</span></span><br><span class="line">        <span class="keyword">await</span> scheduler.ResumeAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>调用</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> fac = HostFactory.New(x =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        x.Service&lt;Manager&gt;(s =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            s.ConstructUsing(name =&gt; <span class="keyword">new</span> Manager());</span><br><span class="line">            s.WhenStarted(m =&gt; m.Start());</span><br><span class="line">            s.WhenStopped(m =&gt; m.Stop());</span><br><span class="line">            s.WhenPaused(m =&gt; m.Pause());</span><br><span class="line">            s.WhenContinued(m =&gt; m.Continue());</span><br><span class="line">        &#125;);</span><br><span class="line">        x.RunAsLocalSystem();</span><br><span class="line">        x.SetDescription(<span class="string">&quot;QuartzTopShelfDemo Windows服务&quot;</span>);</span><br><span class="line">        x.SetDisplayName(<span class="string">&quot;QuartzTopShelfDemo 服务&quot;</span>);</span><br><span class="line">        x.SetServiceName(<span class="string">&quot;QuartzTopShelfDemoService&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    fac.Run();</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    Console.ReadKey();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>配置安装服务</li>
</ol>
<p>安装：TopshelfDemo.exe install<br>启动：TopshelfDemo.exe start<br>卸载：TopshelfDemo.exe uninstall</p>
<p><img src="/images/2018071811491901.png" alt="2018071811491901.png"><br><img src="/images/2018071811491902.png" alt="2018071811491902.png"></p>
<p>参考：<a target="_blank" rel="noopener" href="https://topshelf.readthedocs.io/en/latest/configuration/config_api.html#service-name">https://topshelf.readthedocs.io/en/latest/configuration/config_api.html#service-name</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/07/18/Quartz%E5%92%8CTopShelf%20Windows%E6%9C%8D%E5%8A%A1%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6/" data-id="clnvbvla200a7egur0fjh7mry" data-title="Quartz和TopShelf Windows服务作业调度" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-WinForm/" rel="tag">C#&#x2F;WinForm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Quartz.NET 作业调度使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/07/16/Quartz.NET%20%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2018-07-16T09:29:00.000Z" itemprop="datePublished">2018-07-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-WinForm/">C#/WinForm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/16/Quartz.NET%20%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6%E4%BD%BF%E7%94%A8/">Quartz.NET 作业调度使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Quartz.NET的使用方法有很多，今天使用Quartz.NET3.0.6的时候发现和2.0版本的语法不太一样，百度上找了一圈也没有找到解决办法</p>
<p>后来在<a target="_blank" rel="noopener" href="https://github.com/quartznet/quartznet">GitHub</a>上下载源代码解决了<br><img src="/images/2018071617291901.png" alt="2018071617291901.png"><br>实现每隔10s将时间写入txt文件</p>
<ol>
<li>新建一个类，实现IJob接口的Execute方法<strong>Task Execute(IJobExecutionContext context)</strong></li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TimeJob</span> : <span class="title">IJob</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Execute</span>(<span class="params">IJobExecutionContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filePath = <span class="string">@&quot;D:\\log.txt&quot;</span>;</span><br><span class="line">        File.AppendAllText(filePath, DateTime.Now + Environment.NewLine);</span><br><span class="line">        Console.WriteLine(DateTime.Now + Environment.NewLine);</span><br><span class="line">        <span class="keyword">return</span> Task.FromResult(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>实现任务调度</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    TestJob();</span><br><span class="line">    Console.ReadKey();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">TestJob</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//创建调度器工厂</span></span><br><span class="line">    ISchedulerFactory factory = <span class="keyword">new</span> StdSchedulerFactory();</span><br><span class="line">    <span class="comment">//创建调度器</span></span><br><span class="line">    IScheduler scheduler = <span class="keyword">await</span> factory.GetScheduler();</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//创建一个任务</span></span><br><span class="line">    IJobDetail job = JobBuilder.Create&lt;TimeJob&gt;().WithIdentity(<span class="string">&quot;myJob1&quot;</span>, <span class="string">&quot;group1&quot;</span>).Build();</span><br><span class="line">    <span class="comment">//创建一个触发器</span></span><br><span class="line">    ITrigger trigger = TriggerBuilder.Create().WithIdentity(<span class="string">&quot;myTrigger1&quot;</span>, <span class="string">&quot;group1&quot;</span>).StartNow().</span><br><span class="line">        WithSimpleSchedule(a =&gt; a.WithIntervalInSeconds(<span class="number">10</span>).RepeatForever()).Build();</span><br><span class="line">    <span class="comment">//将任务和触发器添加到调度器里</span></span><br><span class="line">    <span class="keyword">await</span> scheduler.ScheduleJob(job, trigger);</span><br><span class="line">    <span class="comment">//开始执行</span></span><br><span class="line">    <span class="keyword">await</span> scheduler.Start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 参考 <a target="_blank" rel="noopener" href="https://github.com/quartznet/quartznet">https://github.com/quartznet/quartznet</a><br><a target="_blank" rel="noopener" href="https://quartznet.sourceforge.io/apidoc/3.0/html/">https://quartznet.sourceforge.io/apidoc/3.0/html/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/07/16/Quartz.NET%20%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6%E4%BD%BF%E7%94%A8/" data-id="clnvbvla100a4egurasck1wrj" data-title="Quartz.NET 作业调度使用" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-WinForm/" rel="tag">C#&#x2F;WinForm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Epplus导出Excel(DataTable)" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/07/09/Epplus%E5%AF%BC%E5%87%BAExcel(DataTable)/" class="article-date">
  <time class="dt-published" datetime="2018-07-09T09:17:00.000Z" itemprop="datePublished">2018-07-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-WinForm/">C#/WinForm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/09/Epplus%E5%AF%BC%E5%87%BAExcel(DataTable)/">Epplus导出Excel(DataTable)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ol>
<li>先将dataTable转换成流</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Stream <span class="title">DataTableToExcel</span>(<span class="params">DataTable dataTable, <span class="built_in">string</span>[] columns, <span class="built_in">string</span> sheetName</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (ExcelPackage pck = <span class="keyword">new</span> ExcelPackage())</span><br><span class="line">        &#123;</span><br><span class="line">            ExcelWorksheet ws = pck.Workbook.Worksheets.Add(sheetName);</span><br><span class="line">            ws.Cells[<span class="string">&quot;A1&quot;</span>].LoadFromDataTable(dataTable, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= columns.Length; i++) <span class="comment">//设置excel列名</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (ExcelRange rng = ws.Cells[<span class="number">1</span>, i])</span><br><span class="line">                &#123;</span><br><span class="line">                    rng.Style.Font.Bold = <span class="literal">true</span>;</span><br><span class="line">                    rng.Value = columns[i - <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            MemoryStream ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">            pck.SaveAs(ms);</span><br><span class="line">            ms.Flush();</span><br><span class="line">            ms.Position = <span class="number">0</span>;<span class="comment">//指定当前流的位置从0开始</span></span><br><span class="line">            <span class="keyword">return</span> ms;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>设置Excel单元格格式  <strong>ws.Column(1).Style.Numberformat.Format &#x3D; “YYYY-MM-DD HH:mm:ss”</strong></p>
<p>保存excel文件</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ExportExcel</span>(<span class="params">DataTable dt, <span class="built_in">string</span>[] columns, <span class="built_in">string</span> sheetName, DownResult result</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">   </span><br><span class="line">    Stream stream = DataTableToExcel(dt, columns, sheetName);</span><br><span class="line">    ExcelPackage package = <span class="keyword">new</span> ExcelPackage(stream);</span><br><span class="line">    fileName = sheetName + DateTime.Now.ToString(<span class="string">&quot;yyyyMMddHHmmss&quot;</span>) + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">    filePath = HttpContext.Current.Server.MapPath(<span class="string">&quot;~/UploadFile/&quot;</span>);<span class="comment">//文件保存地址  </span></span><br><span class="line">    <span class="keyword">if</span> (!Directory.Exists(filePath))<span class="comment">//如果不存在就创建file文件夹</span></span><br><span class="line">    &#123;</span><br><span class="line">        Directory.CreateDirectory(filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    package.SaveAs(<span class="keyword">new</span> FileInfo(filePath + fileName));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>直接将dataTable 保存为Excel文件</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DataTableToExcel</span>(<span class="params">DataTable dtResult,<span class="built_in">string</span> sheetName</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> path = AppDomain.CurrentDomain.BaseDirectory + DateTime.Now.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>) + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">    FileInfo file = <span class="keyword">new</span> FileInfo(path);</span><br><span class="line">    <span class="keyword">using</span> (ExcelPackage pck = <span class="keyword">new</span> ExcelPackage(file))</span><br><span class="line">    &#123;</span><br><span class="line">        ExcelWorksheet w = pack.Workbook.Worksheets[sheetName]; </span><br><span class="line">        <span class="keyword">if</span> (w != <span class="literal">null</span> &amp;&amp; w.Name.Equals(sheetName)) <span class="comment">//判断是否存在该sheet表，存在则删除</span></span><br><span class="line">            pack.Workbook.Worksheets.Delete(w);</span><br><span class="line">        ExcelWorksheet ws = pack.Workbook.Worksheets.Add(sheetName);</span><br><span class="line">        ws.Cells[<span class="string">&quot;A1&quot;</span>].LoadFromDataTable(dtResult, <span class="literal">true</span>); <span class="comment">//第二个参数设置为true则显示datable表头</span></span><br><span class="line">        pck.Save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/07/09/Epplus%E5%AF%BC%E5%87%BAExcel(DataTable)/" data-id="clnvbvl8g003eegur9z75h13u" data-title="Epplus导出Excel(DataTable)" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-WinForm/" rel="tag">C#&#x2F;WinForm</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/11/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/13/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-WinForm/">C#/WinForm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer/">Computer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML-CSS/">HTML/CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MVC/">MVC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL-SQL-Oracle/">MySQL/SQL/Oracle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/QT/">QT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Search/">Search</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Silverlight/">Silverlight</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WCF/">WCF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-WinForm/" rel="tag">C#&#x2F;WinForm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-C/" rel="tag">C&#x2F;C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Computer/" rel="tag">Computer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML-CSS/" rel="tag">HTML&#x2F;CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/" rel="tag">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVC/" rel="tag">MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL-SQL-Oracle/" rel="tag">MySQL&#x2F;SQL&#x2F;Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Other/" rel="tag">Other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/QT/" rel="tag">QT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Search/" rel="tag">Search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Silverlight/" rel="tag">Silverlight</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tools/" rel="tag">Tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WCF/" rel="tag">WCF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEB/" rel="tag">WEB</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C-WinForm/" style="font-size: 19.23px;">C#/WinForm</a> <a href="/tags/C-C/" style="font-size: 13.85px;">C/C++</a> <a href="/tags/Computer/" style="font-size: 16.15px;">Computer</a> <a href="/tags/HTML-CSS/" style="font-size: 14.62px;">HTML/CSS</a> <a href="/tags/JS/" style="font-size: 16.92px;">JS</a> <a href="/tags/Java/" style="font-size: 15.38px;">Java</a> <a href="/tags/MVC/" style="font-size: 14.62px;">MVC</a> <a href="/tags/MongoDB/" style="font-size: 10.77px;">MongoDB</a> <a href="/tags/MySQL-SQL-Oracle/" style="font-size: 20px;">MySQL/SQL/Oracle</a> <a href="/tags/Other/" style="font-size: 13.85px;">Other</a> <a href="/tags/Python/" style="font-size: 10.77px;">Python</a> <a href="/tags/QT/" style="font-size: 13.08px;">QT</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Search/" style="font-size: 10.77px;">Search</a> <a href="/tags/Silverlight/" style="font-size: 17.69px;">Silverlight</a> <a href="/tags/Tools/" style="font-size: 18.46px;">Tools</a> <a href="/tags/WCF/" style="font-size: 11.54px;">WCF</a> <a href="/tags/WEB/" style="font-size: 12.31px;">WEB</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">八月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">五月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">六月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">四月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">十一月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">十月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">九月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">六月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">五月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">四月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">三月 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">十二月 2011</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/10/17/%E7%A7%BB%E5%8A%A8%E6%9C%BA%E9%A1%B6%E7%9B%92%E5%88%B7%E6%9C%BA/">移动机顶盒刷机</a>
          </li>
        
          <li>
            <a href="/2023/10/17/hiredis%E8%BF%9E%E6%8E%A5redis/">hiredis连接redis</a>
          </li>
        
          <li>
            <a href="/2023/10/13/TVBox%E8%AE%BE%E7%BD%AE%E6%BA%90%E5%8F%8A%E4%BF%AE%E6%94%B9/">TVBox设置源及修改</a>
          </li>
        
          <li>
            <a href="/2023/09/20/hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/">hexo搭建博客</a>
          </li>
        
          <li>
            <a href="/2023/09/15/Linux%20%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/">Linux 操作命令</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 zhang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>